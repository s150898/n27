<!DOCTYPE html>
<html lang="de">  
  <head>    
    <link rel="stylesheet" href="styles.css">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />    
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>N27 - Konto abfragen</title>
  </head>
  <body>    
    <h1>Konto abfragen</h1>  
    <nav>      
      <a href="/"><i class="fa fa-home" aria-hidden="true"></i></a>                        
      <a href="/login">Logout</a>        
      <a href="/impressum">Impressum</a>   
      <a href="mailto:stefan.baeumer@berufskolleg-borken.de"> <i class="fa fa-envelope-o"></i></a>
      <a href="/profilBearbeiten"><i class="fa fa-id-card-o" aria-hidden="true"></i></a>        
    </nav>   
    <form method="POST" action="/kontoAbfragen">          
      <label>Von welchem Konto soll der Kontostand abgefragt werden?</label>                
      <select name="abfrageIban">

      <!-- 
        Alle quellIbans aus dem Datenbank-Result werden in einer Schleife durchlaufen.
        Aus jedem einzelnen Element der Liste quellibans wird die Iban ausgelesen
        -->
      <% for(var i=0; i< abfrageIbans.length; i++) {%>              
        <option value="<%= abfrageIbans[i].iban %>"><%= abfrageIbans[i].iban %></option>                  
      <% } %> 

      </select>        
      <button>Konto abfragen</button>
    </form>  

    <!--
      Hausaufgabe:

      Wenn der Kunde in der App auf Konto abfragen klickt, dann soll er aus seinen Konten das gewünschte wählen können.
      Anscjhließend wird der Kontostand angezeigt.

      Im Einzelnen ist also Folgendes zu tun:
      1. Formular in der kontoAbfragen.ejs einbauen
      2. Auswahlmenü in das Formular einbauen (vgl. ueberweisen.ejs)
      3. In der server.js 'app.get('/kontoAbfragen' ausprogrammieren, so dass beim Laden der Seite nur die 
         eigenen Konten zur Auswahl angeboten werden.
      4. In der server.js eine app.post nau anlegen und ebenfalls ausprogrammieren, indem
          1. die gewählte iban eingelesen wird (req.body....)
          2. die Datenbank so abgefragt wird, dass zu der requesteten iban alle Kontobewegungen ausgelesen werden.
             Dazu gibt es zwei Möglichkeiten: 
              ->Entweder wird eine sogenannte Aggregat-Abfrage gegen die DB gefeuert, die
                dann die aufaddierten Beträge als einzelne Zahl zurückgibt, oder
              ->Alle Beträge werden als Array in Javascript eingelesen und dann in einer Schleife mit jedem Schleifendurchlauf aufaddiert.
      5. Der Result muss dann gerendert weden.
    -->

    <%= meldung %>
  </body>
</html>

